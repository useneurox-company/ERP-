# EMERALD ERP - –†–ê–ë–û–ß–ò–ô –ü–†–û–¶–ï–°–° –ò –ü–†–ê–í–ò–õ–ê

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û

### üõ°Ô∏è PRODUCTION –ë–ê–ó–ê –î–ê–ù–ù–´–• - –ù–ï –¢–†–û–ì–ê–¢–¨!
- **–ù–ò–ö–û–ì–î–ê –Ω–µ —É–¥–∞–ª—è—Ç—å, –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å, –Ω–µ –∏–∑–º–µ–Ω—è—Ç—å production –±–∞–∑—É `emerald_erp`**
- **–í production —Ä–∞–±–æ—Ç–∞—é—Ç –†–ï–ê–õ–¨–ù–´–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò**
- **–ë–∞–∑–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –ü–û–õ–ù–û–ô –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò**
- –õ—é–±—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Å production –ë–î –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ —è–≤–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –û–ö–†–£–ñ–ï–ù–ò–ô

### Production (–ù–ï –¢–†–û–ì–ê–¢–¨ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è!)
```
URL: https://emrld.ru
–°–µ—Ä–≤–µ—Ä: 147.45.146.149
–ü–∞–ø–∫–∞: /var/www/emerald-erp
–ë–î: emerald_erp (PostgreSQL)
PM2: emerald-erp (ID 0, 1)
–ü–æ—Ä—Ç: 5000
–°—Ç–∞—Ç—É—Å: –†–ê–ë–û–ß–ò–ô - —Ç–∞–º —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏!
```

### Staging (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
```
URL: http://147.45.146.149:5001
–°–µ—Ä–≤–µ—Ä: 147.45.146.149
–ü–∞–ø–∫–∞: /var/www/emerald-erp-staging
–ë–î: emerald_erp_staging (PostgreSQL - –∫–æ–ø–∏—è –¥–∞–Ω–Ω—ã—Ö)
PM2: emerald-erp-staging (ID 2)
–ü–æ—Ä—Ç: 5001
–°—Ç–∞—Ç—É—Å: –¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```

### Local (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
```
–ü–∞–ø–∫–∞: c:\NX\Emerald ERP
–ë–î: SQLite (.local/emerald_erp.db)
–ü–æ—Ä—Ç: 5000 (development)
```

---

## üìã –ü–†–û–¶–ï–°–° –†–ê–ó–†–ê–ë–û–¢–ö–ò –ò –î–ï–ü–õ–û–Ø

### 1Ô∏è‚É£ –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–ë–´–°–¢–†–û)
```
1. –†–∞–±–æ—Ç–∞–µ—à—å –ª–æ–∫–∞–ª—å–Ω–æ –≤ c:\NX\Emerald ERP
2. –¢–µ—Å—Ç–∏—Ä—É–µ—à—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—è–µ—à—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
```

### 2Ô∏è‚É£ –î–µ–ø–ª–æ–π –Ω–∞ Staging (–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï)
```
1. –ó–∞–≥—Ä—É–∂–∞–µ—à—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ staging
2. –¢–µ—Å—Ç–∏—Ä—É–µ—à—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∫–æ–ø–∏—è production)
3. –ü—Ä–æ–≤–µ—Ä—è–µ—à—å —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫
4. –ò—Å–ø—Ä–∞–≤–ª—è–µ—à—å –±–∞–≥–∏ –µ—Å–ª–∏ –µ—Å—Ç—å
```

### 3Ô∏è‚É£ –î–µ–ø–ª–æ–π –Ω–∞ Production (–¢–û–õ–¨–ö–û –ü–†–û–í–ï–†–ï–ù–ù–´–ô –ö–û–î!)
```
1. –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ staging
2. –£–±–µ–¥–∏—Å—å —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –ø–æ—Å—Ç—Ä–∞–¥–∞—é—Ç
3. –°–¥–µ–ª–∞–π backup –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
4. –î–µ–ø–ª–æ–π –Ω–∞ production
```

---

## üîê –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ö –°–ï–†–í–ï–†–£

### SSH –ö–ª—é—á (–ò–°–ü–û–õ–¨–ó–£–ï–ú –í–°–ï–ì–î–ê!)
```bash
ssh -i ".ssh\deploy_key" -o StrictHostKeyChecking=no root@147.45.146.149
```

**–í–ê–ñ–ù–û:**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ SSH –∫–ª—é—á `.ssh\deploy_key`
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞—Ä–æ–ª—å
- –ö–ª—é—á –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `.ssh\deploy_key` (–ª–æ–∫–∞–ª—å–Ω–æ)

### SCP –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
```bash
scp -i ".ssh\deploy_key" -o StrictHostKeyChecking=no file.tar.gz root@147.45.146.149:/path/
```

---

## üóÑÔ∏è –ë–ê–ó–´ –î–ê–ù–ù–´–•

### Production –ë–î (emerald_erp)
```
‚õî –ù–ï –¢–†–û–ì–ê–¢–¨! –¢–ê–ú –†–ê–ë–û–¢–ê–Æ–¢ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò!
‚õî –ù–ï –£–î–ê–õ–Ø–¢–¨!
‚õî –ù–ï –ü–ï–†–ï–ó–ê–ü–ò–°–´–í–ê–¢–¨!
‚õî –ù–ï –ò–ó–ú–ï–ù–Ø–¢–¨ –ë–ï–ó –†–ê–ó–†–ï–®–ï–ù–ò–Ø!

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: emerald_user
–ü–∞—Ä–æ–ª—å: EmeraldSecure2025!
–ë–∞–∑–∞: emerald_erp
–•–æ—Å—Ç: localhost:5432
```

### Staging –ë–î (emerald_erp_staging)
```
‚úÖ –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ç–µ—Å—Ç–æ–≤
‚úÖ –ö–æ–ø–∏—è production –¥–∞–Ω–Ω—ã—Ö
‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: emerald_user
–ü–∞—Ä–æ–ª—å: EmeraldSecure2025!
–ë–∞–∑–∞: emerald_erp_staging
–•–æ—Å—Ç: localhost:5432
```

---

## üöÄ –°–ö–†–ò–ü–¢–´ –î–ï–ü–õ–û–Ø

### –î–µ–ø–ª–æ–π –Ω–∞ Staging
```bash
# 1. –°–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏–≤
tar --exclude=node_modules --exclude=.local --exclude=.git --exclude=dist --exclude=*.log -czf deploy.tar.gz *

# 2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp -i ".ssh\deploy_key" -o StrictHostKeyChecking=no deploy.tar.gz root@147.45.146.149:/tmp/

# 3. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ staging
ssh -i ".ssh\deploy_key" -o StrictHostKeyChecking=no root@147.45.146.149 "
  cd /var/www/emerald-erp-staging &&
  tar -xzf /tmp/deploy.tar.gz &&
  rm /tmp/deploy.tar.gz &&
  npm install --omit=dev &&
  npm run build &&
  pm2 restart emerald-erp-staging
"

# 4. –ü–æ—á–∏—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
rm deploy.tar.gz
```

### –î–µ–ø–ª–æ–π –Ω–∞ Production (–û–°–¢–û–†–û–ñ–ù–û!)
```bash
# ‚ö†Ô∏è –¢–û–õ–¨–ö–û –ü–û–°–õ–ï –£–°–ü–ï–®–ù–û–ì–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø –ù–ê STAGING!
# ‚ö†Ô∏è –£–ë–ï–î–ò–°–¨ –ß–¢–û –ö–û–î –ü–†–û–í–ï–†–ï–ù –ò –ë–ï–ó –û–®–ò–ë–û–ö!

# 1. –°–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏–≤
tar --exclude=node_modules --exclude=.local --exclude=.git --exclude=dist --exclude=*.log -czf deploy.tar.gz *

# 2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp -i ".ssh\deploy_key" -o StrictHostKeyChecking=no deploy.tar.gz root@147.45.146.149:/tmp/

# 3. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ production
ssh -i ".ssh\deploy_key" -o StrictHostKeyChecking=no root@147.45.146.149 "
  cd /var/www/emerald-erp &&
  tar -xzf /tmp/deploy.tar.gz &&
  rm /tmp/deploy.tar.gz &&
  npm install --omit=dev &&
  npm run build &&
  pm2 reload emerald-erp
"

# 4. –ü–æ—á–∏—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
rm deploy.tar.gz
```

**–í–ê–ñ–ù–û:** –ù–∞ production –∏—Å–ø–æ–ª—å–∑—É–µ–º `pm2 reload` –≤–º–µ—Å—Ç–æ `restart` –¥–ª—è zero-downtime deployment!

---

## üì¶ PM2 –£–ü–†–ê–í–õ–ï–ù–ò–ï

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
```bash
ssh -i ".ssh\deploy_key" -o StrictHostKeyChecking=no root@147.45.146.149 "pm2 list"
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Staging
```bash
ssh -i ".ssh\deploy_key" -o StrictHostKeyChecking=no root@147.45.146.149 "pm2 restart emerald-erp-staging"
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Production (–ë–ï–ó –î–ê–£–ù–¢–ê–ô–ú–ê)
```bash
ssh -i ".ssh\deploy_key" -o StrictHostKeyChecking=no root@147.45.146.149 "pm2 reload emerald-erp"
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
```bash
# Staging
ssh -i ".ssh\deploy_key" -o StrictHostKeyChecking=no root@147.45.146.149 "pm2 logs emerald-erp-staging --lines 50"

# Production
ssh -i ".ssh\deploy_key" -o StrictHostKeyChecking=no root@147.45.146.149 "pm2 logs emerald-erp --lines 50"
```

---

## üîÑ –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø STAGING –° PRODUCTION

### –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ staging –∏–∑ production
```bash
ssh -i ".ssh\deploy_key" -o StrictHostKeyChecking=no root@147.45.146.149 "
  rsync -av --delete \
    --exclude=node_modules \
    --exclude=.local \
    --exclude=dist \
    /var/www/emerald-erp/ \
    /var/www/emerald-erp-staging/
"
```

### –û–±–Ω–æ–≤–∏—Ç—å –ë–î staging –∏–∑ production
```bash
ssh -i ".ssh\deploy_key" -o StrictHostKeyChecking=no root@147.45.146.149 "
  sudo -u postgres pg_dump emerald_erp | sudo -u postgres psql emerald_erp_staging
"
```

---

## ‚ö†Ô∏è –ü–†–ê–í–ò–õ–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

### ‚úÖ –ú–û–ñ–ù–û:
- –†–∞–±–æ—Ç–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ staging —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å staging –ø—Ä–æ—Ü–µ—Å—Å—ã
- –ò–∑–º–µ–Ω—è—Ç—å staging –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ staging

### ‚ùå –ù–ï–õ–¨–ó–Ø:
- **–£–¥–∞–ª—è—Ç—å production –±–∞–∑—É `emerald_erp`**
- **–ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å production –±–∞–∑—É**
- **–ò–∑–º–µ–Ω—è—Ç—å production –ë–î –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è**
- **–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å production –ø—Ä–æ—Ü–µ—Å—Å—ã –±–µ–∑ –ø—Ä–∏—á–∏–Ω—ã**
- **–î–µ–ø–ª–æ–∏—Ç—å –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –∫–æ–¥ –Ω–∞ production**
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `pm2 restart` –Ω–∞ production (—Ç–æ–ª—å–∫–æ `pm2 reload`)**

---

## üìù –ß–ï–ö–õ–ò–°–¢ –ü–ï–†–ï–î –î–ï–ü–õ–û–ï–ú –ù–ê PRODUCTION

- [ ] ‚úÖ –ö–æ–¥ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] ‚úÖ –ö–æ–¥ –∑–∞–¥–µ–ø–ª–æ–µ–Ω –Ω–∞ staging
- [ ] ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ staging –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] ‚úÖ API —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞ staging
- [ ] ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö staging –≤ –ø–æ—Ä—è–¥–∫–µ
- [ ] ‚úÖ –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö staging
- [ ] ‚úÖ –ü–æ–ª—É—á–µ–Ω–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] ‚úÖ –°–æ–∑–¥–∞–Ω backup production –ë–î (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] ‚ö†Ô∏è –¢–û–õ–¨–ö–û –¢–û–ì–î–ê –¥–µ–ø–ª–æ–π –Ω–∞ production!

---

## üõ†Ô∏è –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ô –°–¢–ï–ö

### Backend
- Node.js 20
- Express.js
- Drizzle ORM
- PostgreSQL (production/staging)
- SQLite (development)

### Frontend
- React + TypeScript
- Vite
- TailwindCSS

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- PM2 (process manager)
- Nginx (reverse proxy)
- UFW (firewall)
- Ubuntu Server

---

## üìû –ö–û–ù–¢–ê–ö–¢–´

**–°–µ—Ä–≤–µ—Ä:** 147.45.146.149
**SSH –ö–ª—é—á:** `.ssh\deploy_key`
**Production URL:** https://emrld.ru
**Staging URL:** http://147.45.146.149:5001

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ö–û–ú–ê–ù–î–´

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å production –ë–î
```bash
ssh -i ".ssh\deploy_key" -o StrictHostKeyChecking=no root@147.45.146.149 "
  sudo -u postgres psql emerald_erp -c 'SELECT count(*) FROM deals;'
"
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å staging –ë–î
```bash
ssh -i ".ssh\deploy_key" -o StrictHostKeyChecking=no root@147.45.146.149 "
  sudo -u postgres psql emerald_erp_staging -c 'SELECT count(*) FROM deals;'
"
```

### Backup production –ë–î
```bash
ssh -i ".ssh\deploy_key" -o StrictHostKeyChecking=no root@147.45.146.149 "
  sudo -u postgres pg_dump emerald_erp | gzip > /var/backups/emerald_erp_$(date +%Y%m%d_%H%M%S).sql.gz
"
```

---

**–ü–û–°–õ–ï–î–ù–ï–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï:** 14 –Ω–æ—è–±—Ä—è 2025

**–ü–û–ú–ù–ò:** Production –±–∞–∑–∞ - —ç—Ç–æ —Å–≤—è—â–µ–Ω–Ω–∞—è –∫–æ—Ä–æ–≤–∞! –ù–µ —Ç—Ä–æ–≥–∞–π –µ—ë –±–µ–∑ –∫—Ä–∞–π–Ω–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏! üêÑ
